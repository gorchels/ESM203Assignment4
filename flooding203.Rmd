---
title: "ESM203Assignment4"
author: "Madeline Gorchels"
date: "12/4/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r} 
#package and df loading code chunk

library(tidyverse)
library(knitr)
library(kableExtra)

```


```{r}
#Defining variables 
high_tide = 2.5
low_tide = -2.5
sea_sd = 3

meter_in_conv = 0.0254

low_est_2020 = 2*meter_in_conv
low_est_2050 = 7*meter_in_conv

mid_25_2020 = 4*meter_in_conv
mid_75_2020 = 8*meter_in_conv

mid_25_2050 = 11*meter_in_conv
mid_75_2050 = 24*meter_in_conv

high_est_2020 = 11*meter_in_conv
high_est_2050 = 31*meter_in_conv
```


```{r}

#creating a dataframe with all the probabilities 

prob_df = data.frame(year = c(2018, 2020, 2050, 2020, 2050, 2020, 2050, 2020, 2050), 
                     percentile = c("NA", "10th percentile","10th percentile","25th percentile","25th percentile","75th percentile","75th percentile","90th percentile","90th percentile"),
                     sea_level_rise = c(0, low_est_2020, low_est_2050, mid_25_2020, mid_25_2050,  0.2032, mid_75_2050, 11*meter_in_conv, high_est_2050),
                     probablity_high_tide = (pnorm(5, mean =prob_df$sea_level_rise+high_tide, sd = sea_sd, lower.tail = FALSE)),
                     probablity_low_tide = (pnorm(5, mean =prob_df$sea_level_rise+low_tide, sd = sea_sd, lower.tail = FALSE)),
                     probablity_high_tide_one = (pnorm(5, mean =prob_df$sea_level_rise+high_tide+1, sd = sea_sd, lower.tail = FALSE)),
                     probablity_low_tide_one = (pnorm(5, mean =prob_df$sea_level_rise+low_tide+1, sd = sea_sd, lower.tail = FALSE)),
                     probablity_high_tide_two = (pnorm(5, mean =prob_df$sea_level_rise+high_tide+2, sd = sea_sd, lower.tail = FALSE)),
                     probablity_low_tide_two = (pnorm(5, mean =prob_df$sea_level_rise+low_tide+2, sd = sea_sd, lower.tail = FALSE)),
                      probablity_high_tide_three = (pnorm(5, mean =prob_df$sea_level_rise+high_tide+3, sd = sea_sd, lower.tail = FALSE)),
                     probablity_low_tide_three = (pnorm(5, mean =prob_df$sea_level_rise+low_tide+3, sd = sea_sd, lower.tail = FALSE))) 

View(prob_df)

```


```{r}
#creating an 2020 only dataframe

prob_2020 = tidy_prob %>% 
  filter(year == 2020)

prob_2050 = tidy_prob %>% 
  filter(year == 2050)
```

```{r}
#I used excel to put the information in prob_df in tidy format. Then I subtracted the probability with no climate change from each value. The probabilty tab shows increase in probability from the baseline scenario. 

tidy_prob = read_csv("NYCflooding.csv") %>% 
  select(-X7,-X8,-X9) %>% 
  mutate(percent_num = case_when(
    percentile == "10th percentile"~10, 
    percentile == "25th percentile"~25,
    percentile == "75th percentile"~75,
    percentile == "90th percentile"~90)) %>% 
  group_by(storm_surge)

```


```{r}
tidy_fig = ggplot(tidy_prob, aes(x = percent_num, y = probabilty_flood))+
  geom_line(color = storm_surge)

tidy_fig
```

